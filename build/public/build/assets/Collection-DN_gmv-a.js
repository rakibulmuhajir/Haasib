import{j as U,k as b,i as $}from"./useForwardExpose-Ca12vFmR.js";import{s as I,a2 as R,af as _,q as N,K as E,H as k,L as x,d as C,M as D,$ as F,S as w,a1 as L,a5 as j,ag as q,ab as B}from"./app-B-wLZQl0.js";import{r as V,S as g}from"./index-D8JUok4n.js";import{a as O}from"./VisuallyHidden-BZkMfMV2.js";function Q(a){return I(()=>R(a)?!!U(a)?.closest("form"):!0)}function X(a,e="reka"){return`${e}-${_?.()}`}function W(a,e){const s=N(a);function l(u){return e[s.value][u]??s.value}return{state:s,dispatch:u=>{s.value=l(u)}}}function z(a,e){const s=N({}),l=N("none"),i=N(a),u=a.value?"mounted":"unmounted";let c;const f=e.value?.ownerDocument.defaultView??b,{state:d,dispatch:o}=W(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),t=n=>{if($){const m=new CustomEvent(n,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(m)}};E(a,async(n,m)=>{const S=m!==n;if(await k(),S){const T=l.value,M=y(e.value);n?(o("MOUNT"),t("enter"),M==="none"&&t("after-enter")):M==="none"||M==="undefined"||s.value?.display==="none"?(o("UNMOUNT"),t("leave"),t("after-leave")):m&&T!==M?(o("ANIMATION_OUT"),t("leave")):(o("UNMOUNT"),t("after-leave"))}},{immediate:!0});const r=n=>{const m=y(e.value),S=m.includes(CSS.escape(n.animationName)),T=d.value==="mounted"?"enter":"leave";if(n.target===e.value&&S&&(t(`after-${T}`),o("ANIMATION_END"),!i.value)){const M=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",c=f?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=M)})}n.target===e.value&&m==="none"&&o("ANIMATION_END")},v=n=>{n.target===e.value&&(l.value=y(e.value))},A=E(e,(n,m)=>{n?(s.value=getComputedStyle(n),n.addEventListener("animationstart",v),n.addEventListener("animationcancel",r),n.addEventListener("animationend",r)):(o("ANIMATION_END"),c!==void 0&&f?.clearTimeout(c),m?.removeEventListener("animationstart",v),m?.removeEventListener("animationcancel",r),m?.removeEventListener("animationend",r))},{immediate:!0}),p=E(d,()=>{const n=y(e.value);l.value=d.value==="mounted"?n:"none"});return x(()=>{A(),p()}),{isPresent:I(()=>["mounted","unmountSuspended"].includes(d.value))}}function y(a){return a&&getComputedStyle(a).animationName||"none"}var Z=C({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(a,{slots:e,expose:s}){const{present:l,forceMount:i}=D(a),u=N(),{isPresent:c}=z(l,u);s({present:c});let f=e.default({present:c.value});f=V(f||[]);const d=F();if(f&&f?.length>1){const o=d?.parent?.type.name?`<${d.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${o}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(t=>`  - ${t}`).join(`
`)].join(`
`))}return()=>i.value||l.value||c.value?w(e.default({present:c.value})[0],{ref:o=>{const t=U(o);return typeof t?.hasAttribute>"u"||(t?.hasAttribute("data-reka-popper-content-wrapper")?u.value=t.firstElementChild:u.value=t),t}}):null}});const P="data-reka-collection-item";function ee(a={}){const{key:e="",isProvider:s=!1}=a,l=`${e}CollectionProvider`;let i;if(s){const t=N(new Map);i={collectionRef:N(),itemMap:t},B(l,i)}else i=L(l);const u=(t=!1)=>{const r=i.collectionRef.value;if(!r)return[];const v=Array.from(r.querySelectorAll(`[${P}]`)),p=Array.from(i.itemMap.value.values()).sort((h,n)=>v.indexOf(h.ref)-v.indexOf(n.ref));return t?p:p.filter(h=>h.ref.dataset.disabled!=="")},c=C({name:"CollectionSlot",setup(t,{slots:r}){const{primitiveElement:v,currentElement:A}=O();return E(A,()=>{i.collectionRef.value=A.value}),()=>w(g,{ref:v},r)}}),f=C({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(t,{slots:r,attrs:v}){const{primitiveElement:A,currentElement:p}=O();return j(h=>{if(p.value){const n=q(p.value);i.itemMap.value.set(n,{ref:p.value,value:t.value}),h(()=>i.itemMap.value.delete(n))}}),()=>w(g,{...v,[P]:"",ref:A},r)}}),d=I(()=>Array.from(i.itemMap.value.values())),o=I(()=>i.itemMap.value.size);return{getItems:u,reactiveItems:d,itemMapSize:o,CollectionSlot:c,CollectionItem:f}}export{Z as P,ee as a,Q as b,X as u};
