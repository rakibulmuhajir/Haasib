import{d as L,s as I,x as z,K as M,c as m,a as l,u as e,h as H,w as o,b as a,y as K,j as w,o as d,F as c,r as v,t as i,e as u,i as _,O as G,ao as J,A as Q,f as W}from"./app-B-wLZQl0.js";import{_ as X}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as T}from"./index-D8JUok4n.js";import{_ as q}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as Y}from"./Textarea.vue_vue_type_script_setup_true_lang-DrbQ2zws.js";import{_ as V,a as k,b as x,c as $,d as y}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as S,a as C}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as N}from"./CardDescription.vue_vue_type_script_setup_true_lang-D23jLuEj.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{z as O}from"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import{B as Z}from"./building-YkSJqe0l.js";import{C as h}from"./credit-card-CZIyPTcw.js";import{F as ee}from"./file-text-CFHWSPvd.js";import{A as te}from"./arrow-left-DSX0n2_N.js";import{S as le}from"./save-CBmuHaqJ.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./loader-circle-BSwxCoSE.js";import"./createLucideIcon-CbxkoCx6.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./useForwardExpose-Ca12vFmR.js";import"./index-a73qSWOM.js";import"./VisuallyHidden-BZkMfMV2.js";import"./Collection-DN_gmv-a.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./check-DogY6QNG.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./nullish-CHIgUVhi.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./plus-C63jdNg7.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";const re={key:0,class:"rounded-md bg-destructive/15 p-4"},oe={class:"text-sm text-destructive"},ne={class:"list-disc list-inside mt-2"},ae={key:0,class:"text-sm text-destructive mt-1"},ue={class:"text-sm text-muted-foreground mt-1"},de={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},ie=["id","value"],se=["for"],me={class:"text-sm font-medium"},fe={class:"flex justify-between"},pe={class:"font-bold"},ce={class:"flex justify-between text-sm text-muted-foreground"},_e={key:0,class:"flex justify-between text-sm text-muted-foreground"},lt=L({__name:"Create",props:{company:{},customers:{},invoices:{},currencies:{},depositAccounts:{},arAccounts:{},preselect:{}},setup(b){const s=b,E=I(()=>[{title:"Dashboard",href:"/dashboard"},{title:s.company.name,href:`/${s.company.slug}`},{title:"Payments",href:`/${s.company.slug}/payments`},{title:"Record Payment"}]),R=s.preselect?.invoice_id?s.invoices.find(p=>p.id===s.preselect?.invoice_id):null,n=z({customer_id:s.preselect?.customer_id||"",invoice_id:s.preselect?.invoice_id||"",amount:R?.balance||0,currency:R?.currency||s.company.base_currency,payment_method:"bank_transfer",reference_number:"",payment_date:new Date().toISOString().split("T")[0],notes:"",deposit_account_id:"",ar_account_id:"company_default"}),j=[{value:"cash",label:"Cash",icon:O},{value:"bank_transfer",label:"Bank Transfer",icon:Z},{value:"card",label:"Card",icon:h},{value:"cheque",label:"Cheque",icon:ee},{value:"other",label:"Other",icon:O}],g=I(()=>n.customer_id?s.invoices.filter(p=>p.customer_id===n.customer_id):[]),D=I(()=>n.invoice_id?s.invoices.find(p=>p.id===n.invoice_id):null);M(()=>n.customer_id,()=>{n.invoice_id="",g.value.length===1&&(n.invoice_id=g.value[0].id,n.currency=g.value[0].currency)}),M(()=>n.invoice_id,()=>{D.value&&(n.currency=D.value.currency,n.amount===0&&(n.amount=D.value.balance))});const P=(p,t)=>new Intl.NumberFormat("en-US",{style:"currency",currency:t||n.currency||"USD"}).format(p),F=()=>{n.post(`/${s.company.slug}/payments`)};return(p,t)=>(d(),m(c,null,[l(e(H),{title:"Record Payment"}),l(X,{title:"Record Payment",breadcrumbs:E.value},{actions:o(()=>[l(e(T),{variant:"outline",onClick:t[0]||(t[0]=r=>e(W).get(`/${b.company.slug}/payments`))},{default:o(()=>[l(e(te),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=u(" Back ",-1))]),_:1}),l(e(T),{onClick:F,disabled:e(n).processing},{default:o(()=>[l(e(le),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=u(" Record Payment ",-1))]),_:1},8,["disabled"])]),default:o(()=>[a("form",{onSubmit:K(F,["prevent"]),class:"space-y-6"},[Object.keys(e(n).errors).length>0?(d(),m("div",re,[a("div",oe,[t[13]||(t[13]=a("p",{class:"font-medium"},"Please fix the following errors:",-1)),a("ul",ne,[(d(!0),m(c,null,v(e(n).errors,(r,B)=>(d(),m("li",{key:B},i(r),1))),128))])])])):w("",!0),l(e(S),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(A),null,{default:o(()=>[...t[14]||(t[14]=[u("Payment Information",-1)])]),_:1}),l(e(N),null,{default:o(()=>[...t[15]||(t[15]=[u("Enter the basic payment details",-1)])]),_:1})]),_:1}),l(e(C),{class:"grid grid-cols-1 md:grid-cols-2 gap-4"},{default:o(()=>[a("div",null,[l(e(f),{for:"customer_id"},{default:o(()=>[...t[16]||(t[16]=[u("Customer *",-1)])]),_:1}),l(e(V),{modelValue:e(n).customer_id,"onUpdate:modelValue":t[1]||(t[1]=r=>e(n).customer_id=r),required:""},{default:o(()=>[l(e(k),null,{default:o(()=>[l(e(x),{placeholder:"Select a customer"})]),_:1}),l(e($),null,{default:o(()=>[(d(!0),m(c,null,v(b.customers.filter(r=>r.id&&r.id!==""),r=>(d(),_(e(y),{key:r.id,value:r.id},{default:o(()=>[u(i(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[l(e(f),{for:"ar_account_id"},{default:o(()=>[...t[17]||(t[17]=[u("AR Account",-1)])]),_:1}),l(e(V),{modelValue:e(n).ar_account_id,"onUpdate:modelValue":t[2]||(t[2]=r=>e(n).ar_account_id=r)},{default:o(()=>[l(e(k),{id:"ar_account_id"},{default:o(()=>[l(e(x),{placeholder:"Use company default"})]),_:1}),l(e($),null,{default:o(()=>[l(e(y),{value:"company_default"},{default:o(()=>[...t[18]||(t[18]=[u("Use company default",-1)])]),_:1}),(d(!0),m(c,null,v(s.arAccounts||[],r=>(d(),_(e(y),{key:r.id,value:r.id},{default:o(()=>[u(i(r.code)+" — "+i(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[l(e(f),{for:"invoice_id"},{default:o(()=>[...t[19]||(t[19]=[u("Apply to Invoice *",-1)])]),_:1}),l(e(V),{modelValue:e(n).invoice_id,"onUpdate:modelValue":t[3]||(t[3]=r=>e(n).invoice_id=r),disabled:!e(n).customer_id,required:""},{default:o(()=>[l(e(k),null,{default:o(()=>[l(e(x),{placeholder:e(n).customer_id?"Select an invoice":"Select a customer first"},null,8,["placeholder"])]),_:1}),l(e($),null,{default:o(()=>[g.value.length>0?(d(!0),m(c,{key:0},v(g.value,r=>(d(),_(e(y),{key:r.id,value:r.id},{default:o(()=>[u(i(r.invoice_number)+" - "+i(P(r.balance,r.currency))+" due ",1)]),_:2},1032,["value"]))),128)):(d(),_(e(y),{key:1,value:"none",disabled:""},{default:o(()=>[u(i(e(n).customer_id?"No unpaid invoices":"Select a customer first"),1)]),_:1}))]),_:1})]),_:1},8,["modelValue","disabled"]),e(n).errors.invoice_id?(d(),m("p",ae,i(e(n).errors.invoice_id),1)):w("",!0)]),a("div",null,[l(e(f),{for:"amount"},{default:o(()=>[...t[20]||(t[20]=[u("Amount *",-1)])]),_:1}),l(e(q),{id:"amount",modelValue:e(n).amount,"onUpdate:modelValue":t[4]||(t[4]=r=>e(n).amount=r),modelModifiers:{number:!0},type:"number",min:"0.01",step:"0.01",placeholder:"0.00",required:""},null,8,["modelValue"]),a("p",ue,i(P(e(n).amount)),1)]),a("div",null,[l(e(f),{for:"payment_date"},{default:o(()=>[...t[21]||(t[21]=[u("Payment Date *",-1)])]),_:1}),l(e(q),{id:"payment_date",modelValue:e(n).payment_date,"onUpdate:modelValue":t[5]||(t[5]=r=>e(n).payment_date=r),type:"date",required:""},null,8,["modelValue"])]),a("div",null,[l(e(f),{for:"deposit_account_id"},{default:o(()=>[...t[22]||(t[22]=[u("Deposit To *",-1)])]),_:1}),l(e(V),{modelValue:e(n).deposit_account_id,"onUpdate:modelValue":t[6]||(t[6]=r=>e(n).deposit_account_id=r),required:""},{default:o(()=>[l(e(k),{id:"deposit_account_id"},{default:o(()=>[l(e(x),{placeholder:"Select bank/cash account"})]),_:1}),l(e($),null,{default:o(()=>[(d(!0),m(c,null,v(s.depositAccounts||[],r=>(d(),_(e(y),{key:r.id,value:r.id},{default:o(()=>[u(i(r.code)+" — "+i(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[l(e(f),{for:"currency"},{default:o(()=>[...t[23]||(t[23]=[u("Currency *",-1)])]),_:1}),l(e(V),{modelValue:e(n).currency,"onUpdate:modelValue":t[7]||(t[7]=r=>e(n).currency=r),required:""},{default:o(()=>[l(e(k),null,{default:o(()=>[l(e(x),{placeholder:"Select currency"})]),_:1}),l(e($),null,{default:o(()=>[(d(!0),m(c,null,v(b.currencies,r=>(d(),_(e(y),{key:r.currency_code,value:r.currency_code},{default:o(()=>[u(i(r.currency_code)+i(r.is_base?" (Base)":""),1)]),_:2},1032,["value"]))),128)),b.currencies.length===0?(d(),_(e(y),{key:0,value:"USD"},{default:o(()=>[...t[24]||(t[24]=[u("USD",-1)])]),_:1})):w("",!0)]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[l(e(f),{for:"reference_number"},{default:o(()=>[...t[25]||(t[25]=[u("Reference Number",-1)])]),_:1}),l(e(q),{id:"reference_number",modelValue:e(n).reference_number,"onUpdate:modelValue":t[8]||(t[8]=r=>e(n).reference_number=r),placeholder:"Check #, transaction ID, etc."},null,8,["modelValue"])])]),_:1})]),_:1}),l(e(S),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(A),null,{default:o(()=>[...t[26]||(t[26]=[u("Payment Method",-1)])]),_:1}),l(e(N),null,{default:o(()=>[...t[27]||(t[27]=[u("How was this payment made?",-1)])]),_:1})]),_:1}),l(e(C),null,{default:o(()=>[a("div",de,[(d(),m(c,null,v(j,r=>a("div",{key:r.value,class:"relative"},[G(a("input",{id:r.value,"onUpdate:modelValue":t[9]||(t[9]=B=>e(n).payment_method=B),value:r.value,type:"radio",class:"peer sr-only"},null,8,ie),[[J,e(n).payment_method]]),a("label",{for:r.value,class:"flex flex-col items-center justify-center rounded-lg border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-checked:border-primary peer-checked:bg-primary peer-checked:text-primary-foreground cursor-pointer"},[(d(),_(Q(r.icon),{class:"h-6 w-6 mb-2"})),a("span",me,i(r.label),1)],8,se)])),64))])]),_:1})]),_:1}),l(e(S),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(A),null,{default:o(()=>[...t[28]||(t[28]=[u("Additional Information",-1)])]),_:1}),l(e(N),null,{default:o(()=>[...t[29]||(t[29]=[u("Any additional notes about this payment",-1)])]),_:1})]),_:1}),l(e(C),null,{default:o(()=>[a("div",null,[l(e(f),{for:"notes"},{default:o(()=>[...t[30]||(t[30]=[u("Notes",-1)])]),_:1}),l(e(Y),{id:"notes",modelValue:e(n).notes,"onUpdate:modelValue":t[10]||(t[10]=r=>e(n).notes=r),placeholder:"Additional payment notes...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1}),l(e(S),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(A),null,{default:o(()=>[...t[31]||(t[31]=[u("Payment Summary",-1)])]),_:1})]),_:1}),l(e(C),{class:"space-y-3"},{default:o(()=>[a("div",fe,[t[32]||(t[32]=a("span",null,"Payment Amount:",-1)),a("span",pe,i(P(e(n).amount)),1)]),a("div",ce,[t[33]||(t[33]=a("span",null,"Payment Method:",-1)),a("span",null,i(j.find(r=>r.value===e(n).payment_method)?.label),1)]),e(n).reference_number?(d(),m("div",_e,[t[34]||(t[34]=a("span",null,"Reference:",-1)),a("span",null,i(e(n).reference_number),1)])):w("",!0)]),_:1})]),_:1})],32)]),_:1},8,["breadcrumbs"])],64))}});export{lt as default};
