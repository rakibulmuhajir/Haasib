import{d as z,s as w,q as G,x as H,c as y,a as l,u as e,h as J,w as o,b as a,y as K,e as u,o as i,F as V,r as A,i as S,t as d,f as W}from"./app-B-wLZQl0.js";import{_ as X}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as k}from"./index-D8JUok4n.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as j}from"./Textarea.vue_vue_type_script_setup_true_lang-DrbQ2zws.js";import{_ as D,a as T,b as B,c as F,d as b}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as I,a as g}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as L}from"./CardDescription.vue_vue_type_script_setup_true_lang-D23jLuEj.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as x}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{P as Y}from"./plus-C63jdNg7.js";import{A as Z}from"./arrow-left-DSX0n2_N.js";import{S as h}from"./save-CBmuHaqJ.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import"./useForwardExpose-Ca12vFmR.js";import"./VisuallyHidden-BZkMfMV2.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./Collection-DN_gmv-a.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./createLucideIcon-CbxkoCx6.js";import"./check-DogY6QNG.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./file-text-CFHWSPvd.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";import"./loader-circle-BSwxCoSE.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./index-a73qSWOM.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./nullish-CHIgUVhi.js";const ee={class:"col-span-5"},te={class:"col-span-2"},le={class:"col-span-2"},oe={class:"col-span-2"},ne={class:"col-span-2 flex items-center text-sm"},ae={class:"flex justify-between text-sm"},ue={class:"flex justify-between text-sm"},se={class:"flex justify-between text-lg font-bold"},He=z({__name:"Create",props:{company:{},customers:{},revenueAccounts:{},arAccounts:{}},setup(q){const c=q,O=w(()=>[{title:"Dashboard",href:"/dashboard"},{title:c.company.name,href:`/${c.company.slug}`},{title:"Invoices",href:`/${c.company.slug}/invoices`},{title:"Create"}]),m=G([{description:"",quantity:1,unit_price:0,tax_rate:0,discount_amount:0}]),s=H({customer_id:"",line_items:m.value,ar_account_id:"",currency:c.company.base_currency,invoice_date:new Date().toISOString().split("T")[0],due_date:"",description:"",reference:"",payment_terms:30,notes:""}),N=w(()=>m.value.reduce((p,t)=>{const n=t.quantity*t.unit_price,f=t.discount_amount||0;return p+(n-f)},0)),P=w(()=>m.value.reduce((p,t)=>{const n=t.quantity*t.unit_price,f=t.discount_amount||0,r=n-f,Q=(t.tax_rate||0)/100;return p+r*Q},0)),R=w(()=>N.value+P.value),E=()=>{m.value.push({description:"",quantity:1,unit_price:0,tax_rate:0,discount_amount:0}),s.line_items=m.value},C=(p,t,n)=>{m.value[p][t]=n,s.line_items=m.value},M=()=>{s.post(`/${c.company.slug}/invoices`)},$=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:s.currency||"USD"}).format(p);return(p,t)=>(i(),y(V,null,[l(e(J),{title:"Create Invoice"}),l(X,{title:"Create Invoice",breadcrumbs:O.value},{actions:o(()=>[l(e(k),{variant:"outline",onClick:t[0]||(t[0]=n=>e(W).get(`/${q.company.slug}/invoices`))},{default:o(()=>[l(e(Z),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=u(" Back ",-1))]),_:1}),l(e(k),{onClick:M,disabled:e(s).processing},{default:o(()=>[l(e(h),{class:"mr-2 h-4 w-4"}),t[10]||(t[10]=u(" Create Invoice ",-1))]),_:1},8,["disabled"])]),default:o(()=>[a("form",{onSubmit:K(M,["prevent"]),class:"space-y-6"},[l(e(I),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(x),null,{default:o(()=>[...t[11]||(t[11]=[u("Customer Information",-1)])]),_:1}),l(e(L),null,{default:o(()=>[...t[12]||(t[12]=[u("Select the customer for this invoice",-1)])]),_:1})]),_:1}),l(e(g),{class:"space-y-4"},{default:o(()=>[a("div",null,[l(e(_),{for:"customer_id"},{default:o(()=>[...t[13]||(t[13]=[u("Customer *",-1)])]),_:1}),l(e(D),{modelValue:e(s).customer_id,"onUpdate:modelValue":t[1]||(t[1]=n=>e(s).customer_id=n),required:""},{default:o(()=>[l(e(T),null,{default:o(()=>[l(e(B),{placeholder:"Select a customer"})]),_:1}),l(e(F),null,{default:o(()=>[(i(!0),y(V,null,A(q.customers,n=>(i(),S(e(b),{key:n.id,value:n.id},{default:o(()=>[u(d(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),a("div",null,[l(e(_),{for:"ar_account_id"},{default:o(()=>[...t[14]||(t[14]=[u("AR Account",-1)])]),_:1}),l(e(D),{modelValue:e(s).ar_account_id,"onUpdate:modelValue":t[2]||(t[2]=n=>e(s).ar_account_id=n)},{default:o(()=>[l(e(T),{id:"ar_account_id"},{default:o(()=>[l(e(B),{placeholder:"Use company default"})]),_:1}),l(e(F),null,{default:o(()=>[l(e(b),{value:"__none"},{default:o(()=>[...t[15]||(t[15]=[u("Use company default",-1)])]),_:1}),(i(!0),y(V,null,A(c.arAccounts||[],n=>(i(),S(e(b),{key:n.id,value:n.id},{default:o(()=>[u(d(n.code)+" — "+d(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),l(e(I),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(x),null,{default:o(()=>[...t[16]||(t[16]=[u("Invoice Details",-1)])]),_:1}),l(e(L),null,{default:o(()=>[...t[17]||(t[17]=[u("Basic information about the invoice",-1)])]),_:1})]),_:1}),l(e(g),{class:"grid grid-cols-1 md:grid-cols-2 gap-4"},{default:o(()=>[a("div",null,[l(e(_),{for:"invoice_date"},{default:o(()=>[...t[18]||(t[18]=[u("Invoice Date *",-1)])]),_:1}),l(e(v),{id:"invoice_date",modelValue:e(s).invoice_date,"onUpdate:modelValue":t[3]||(t[3]=n=>e(s).invoice_date=n),type:"date",required:""},null,8,["modelValue"])]),a("div",null,[l(e(_),{for:"due_date"},{default:o(()=>[...t[19]||(t[19]=[u("Due Date",-1)])]),_:1}),l(e(v),{id:"due_date",modelValue:e(s).due_date,"onUpdate:modelValue":t[4]||(t[4]=n=>e(s).due_date=n),type:"date"},null,8,["modelValue"])]),a("div",null,[l(e(_),{for:"reference"},{default:o(()=>[...t[20]||(t[20]=[u("Reference",-1)])]),_:1}),l(e(v),{id:"reference",modelValue:e(s).reference,"onUpdate:modelValue":t[5]||(t[5]=n=>e(s).reference=n),placeholder:"PO number or reference"},null,8,["modelValue"])]),a("div",null,[l(e(_),{for:"payment_terms"},{default:o(()=>[...t[21]||(t[21]=[u("Payment Terms (days)",-1)])]),_:1}),l(e(v),{id:"payment_terms",modelValue:e(s).payment_terms,"onUpdate:modelValue":t[6]||(t[6]=n=>e(s).payment_terms=n),modelModifiers:{number:!0},type:"number",min:"0",max:"365"},null,8,["modelValue"])])]),_:1})]),_:1}),l(e(I),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(x),null,{default:o(()=>[...t[22]||(t[22]=[u("Line Items",-1)])]),_:1}),l(e(L),null,{default:o(()=>[...t[23]||(t[23]=[u("Add products or services to invoice",-1)])]),_:1})]),_:1}),l(e(g),{class:"space-y-4"},{default:o(()=>[t[26]||(t[26]=a("div",{class:"grid grid-cols-12 gap-2 text-sm text-muted-foreground font-medium"},[a("div",{class:"col-span-5"},"Description"),a("div",{class:"col-span-2"},"Quantity"),a("div",{class:"col-span-2"},"Unit Price"),a("div",{class:"col-span-2"},"Income Account"),a("div",{class:"col-span-1"},"Total")],-1)),(i(!0),y(V,null,A(m.value,(n,f)=>(i(),y("div",{key:f,class:"grid grid-cols-12 gap-2"},[a("div",ee,[l(e(v),{modelValue:n.description,"onUpdate:modelValue":r=>n.description=r,placeholder:"Item description",onInput:r=>C(f,"description",r.target.value),required:""},null,8,["modelValue","onUpdate:modelValue","onInput"])]),a("div",te,[l(e(v),{modelValue:n.quantity,"onUpdate:modelValue":r=>n.quantity=r,modelModifiers:{number:!0},type:"number",min:"0.01",step:"0.01",onInput:r=>C(f,"quantity",parseFloat(r.target.value)||0),required:""},null,8,["modelValue","onUpdate:modelValue","onInput"])]),a("div",le,[l(e(v),{modelValue:n.unit_price,"onUpdate:modelValue":r=>n.unit_price=r,modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",onInput:r=>C(f,"unit_price",parseFloat(r.target.value)||0),required:""},null,8,["modelValue","onUpdate:modelValue","onInput"])]),a("div",oe,[l(e(D),{modelValue:n.income_account_id,"onUpdate:modelValue":r=>n.income_account_id=r},{default:o(()=>[l(e(T),null,{default:o(()=>[l(e(B),{placeholder:"Income acct"})]),_:1}),l(e(F),null,{default:o(()=>[l(e(b),{value:"__none"},{default:o(()=>[...t[24]||(t[24]=[u("Use default",-1)])]),_:1}),(i(!0),y(V,null,A(c.revenueAccounts||[],r=>(i(),S(e(b),{key:r.id,value:r.id},{default:o(()=>[u(d(r.code)+" — "+d(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),a("div",ne,d($(n.quantity*n.unit_price)),1)]))),128)),l(e(k),{type:"button",variant:"outline",onClick:E,class:"w-full"},{default:o(()=>[l(e(Y),{class:"mr-2 h-4 w-4"}),t[25]||(t[25]=u(" Add Line Item ",-1))]),_:1})]),_:1})]),_:1}),l(e(I),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(x),null,{default:o(()=>[...t[27]||(t[27]=[u("Invoice Summary",-1)])]),_:1})]),_:1}),l(e(g),{class:"space-y-2"},{default:o(()=>[a("div",ae,[t[28]||(t[28]=a("span",null,"Subtotal:",-1)),a("span",null,d($(N.value)),1)]),a("div",ue,[t[29]||(t[29]=a("span",null,"Tax:",-1)),a("span",null,d($(P.value)),1)]),a("div",se,[t[30]||(t[30]=a("span",null,"Total:",-1)),a("span",null,d($(R.value)),1)])]),_:1})]),_:1}),l(e(I),null,{default:o(()=>[l(e(U),null,{default:o(()=>[l(e(x),null,{default:o(()=>[...t[31]||(t[31]=[u("Additional Information",-1)])]),_:1})]),_:1}),l(e(g),{class:"space-y-4"},{default:o(()=>[a("div",null,[l(e(_),{for:"description"},{default:o(()=>[...t[32]||(t[32]=[u("Description",-1)])]),_:1}),l(e(j),{id:"description",modelValue:e(s).description,"onUpdate:modelValue":t[7]||(t[7]=n=>e(s).description=n),placeholder:"Invoice description or internal notes",rows:"3"},null,8,["modelValue"])]),a("div",null,[l(e(_),{for:"notes"},{default:o(()=>[...t[33]||(t[33]=[u("Customer Notes",-1)])]),_:1}),l(e(j),{id:"notes",modelValue:e(s).notes,"onUpdate:modelValue":t[8]||(t[8]=n=>e(s).notes=n),placeholder:"Notes that will be visible to the customer",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1})],32)]),_:1},8,["breadcrumbs"])],64))}});export{He as default};
