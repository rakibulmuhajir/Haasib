import{d as Z,s as v,q as V,x as ee,c as x,a as t,u as e,h as te,w as n,b as r,y as se,e as u,t as i,o as p,F as $,r as D,i as I,j as C,B as z,f as oe}from"./app-B-wLZQl0.js";import{u as ae,t as le,v as re,C as ne,w as de}from"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import{u as ie}from"./useFormFeedback-CE35LO4q.js";import{_ as ue}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as ce,a as me,b as pe,c as _e,Q as fe}from"./QuickAddModal-BiBdCYPB.js";import{_ as b}from"./index-D8JUok4n.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as L}from"./Textarea.vue_vue_type_script_setup_true_lang-DrbQ2zws.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as ye}from"./Separator.vue_vue_type_script_setup_true_lang-8_dGzQCj.js";import{_ as ve,a as xe}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as be}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as ge}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{_ as he,a as we,b as Ve,c as $e,d as Ce}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as ke}from"./SelectGroup.vue_vue_type_script_setup_true_lang-Cng8hgfl.js";import{_ as Ue}from"./SelectLabel.vue_vue_type_script_setup_true_lang-C2EqSPuI.js";import{P as Se}from"./plus-C63jdNg7.js";import{T as Ae}from"./trash-2-BxVbfljz.js";import{C as Te}from"./credit-card-CZIyPTcw.js";import{S as De}from"./save-CBmuHaqJ.js";import{A as Ie}from"./arrow-left-DSX0n2_N.js";import"./useForwardExpose-Ca12vFmR.js";import"./VisuallyHidden-BZkMfMV2.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./Collection-DN_gmv-a.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./createLucideIcon-CbxkoCx6.js";import"./check-DogY6QNG.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./file-text-CFHWSPvd.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./loader-circle-BSwxCoSE.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./index-a73qSWOM.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BiuISOh6.js";import"./user-tDll6vy-.js";import"./clock-9a58COAh.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-yNvHsWJi.js";import"./nullish-CHIgUVhi.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./RovingFocusItem-PDr5bOed.js";import"./percent-CJFopfja.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DUuIDTHQ.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-CLZwVYr3.js";const je={class:"mx-auto w-full max-w-5xl"},Ne={class:"space-y-5 lg:col-span-7"},qe={class:"space-y-1.5"},Be={class:"space-y-2"},Pe={class:"flex items-center justify-between gap-3"},Fe={class:"space-y-3"},Qe={class:"mb-3 flex items-center justify-between gap-2"},ze={class:"text-sm font-medium text-foreground"},Le={class:"flex flex-col gap-3 sm:flex-row sm:items-start"},Me={class:"flex-1 space-y-1.5"},Ee={class:"w-full space-y-1.5 sm:w-[220px]"},Oe={class:"mt-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Re={class:"flex items-center gap-2"},Ke={key:0,class:"flex items-center justify-between gap-3 sm:justify-end"},Ye={class:"space-y-1.5"},Ge={key:0,class:"text-sm text-destructive"},He={class:"space-y-1.5"},Je={class:"grid gap-4 sm:grid-cols-2"},We={class:"space-y-2"},Xe={class:"space-y-2"},Ze={class:"space-y-2"},et={class:"space-y-2"},tt={class:"lg:col-span-5"},st={class:"text-4xl font-semibold leading-none tabular-nums"},ot={class:"space-y-2 rounded-lg border border-border/70 bg-muted/15 p-3"},at={class:"flex justify-between text-sm"},lt={class:"text-muted-foreground"},rt={class:"tabular-nums text-foreground/90"},nt={key:0,class:"flex justify-between text-sm animate-in fade-in duration-200"},dt={class:"text-muted-foreground"},it={class:"tabular-nums text-foreground/90"},ut={class:"flex flex-col gap-2.5"},ct={class:"text-xs text-muted-foreground"},us=Z({__name:"QuickCreate",props:{company:{},recentVendors:{},expenseAccounts:{},defaultTaxCode:{},defaultTerms:{}},setup(U){const c=U,{t:d,tpl:j}=ae(),{showSuccess:N,showError:q}=ie(),M=v(()=>[{title:"Dashboard",href:"/dashboard"},{title:c.company.name,href:`/${c.company.slug}`},{title:d("bills"),href:`/${c.company.slug}/bills`},{title:d("newBill")}]),E=v(()=>{if(!c.expenseAccounts?.length)return[];const a={};for(const s of c.expenseAccounts){const l=s.subtype||s.type||"Other";a[l]||(a[l]=[]),a[l].push(s)}return Object.entries(a).map(([s,l])=>({label:s.replace(/_/g," ").replace(/\b\w/g,m=>m.toUpperCase()),accounts:l}))}),g=V(!1),B=V(null),f=V(c.defaultTaxCode||null),S=V(!1),P=()=>({description:"",quantity:1,unit_price:null}),o=ee({vendor_id:null,account_id:null,apply_tax:!1,line_items:[P()],due_date:null,bill_date:new Date().toISOString().split("T")[0],bill_number:"",reference:"",notes:"",currency:c.company.base_currency,base_currency:c.company.base_currency,exchange_rate:null,payment_terms:c.company.default_payment_terms??c.defaultTerms??30,status:"draft",pay_immediately:!1}),h=v(()=>B.value?.payment_terms||c.company.default_payment_terms||c.defaultTerms||30),w=v(()=>o.line_items),A=v(()=>w.value.reduce((a,s)=>{const l=s.unit_price??0;return a+s.quantity*l},0)),F=v(()=>!o.apply_tax||!f.value?0:A.value*(f.value.rate/100)),O=v(()=>A.value+F.value),R=v(()=>!!o.vendor_id&&w.value.length>0&&w.value.every(a=>a.description.trim().length>0)&&w.value.every(a=>(a.unit_price??0)>0)&&!!o.account_id),Q=a=>{B.value=a,o.vendor_id=a.id},K=a=>{Q(a),g.value=!1},Y=a=>{f.value=a},G=a=>{o.account_id=String(a)},H=()=>{o.line_items.push(P())},J=a=>{o.line_items.length<=1||o.line_items.splice(a,1)},W=()=>{o.transform(a=>({...a,status:"draft",pay_immediately:!1,payment_terms:h.value,line_items:a.line_items.map(s=>({description:s.description,quantity:s.quantity,unit_price:s.unit_price??0,tax_rate:a.apply_tax&&f.value?f.value.rate:null,discount_rate:null,expense_account_id:a.account_id}))})).post(`/${c.company.slug}/bills`,{preserveScroll:!0,onSuccess:()=>{N(d("billSaved"))},onError:a=>q(a)})},X=()=>{o.transform(a=>({...a,status:"received",pay_immediately:!0,payment_terms:h.value,line_items:a.line_items.map(s=>({description:s.description,quantity:s.quantity,unit_price:s.unit_price??0,tax_rate:a.apply_tax&&f.value?f.value.rate:null,discount_rate:null,expense_account_id:a.account_id}))})).post(`/${c.company.slug}/bills`,{preserveScroll:!0,onSuccess:()=>{N(d("billSavedAndPaid"))},onError:a=>q(a)})},T=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:c.company.base_currency||"USD"}).format(a);return(a,s)=>(p(),x($,null,[t(e(te),{title:e(d)("newBill")},null,8,["title"]),t(ue,{title:e(d)("newBill"),breadcrumbs:M.value},{actions:n(()=>[t(e(b),{variant:"outline",onClick:s[0]||(s[0]=l=>e(oe).get(`/${U.company.slug}/bills`))},{default:n(()=>[t(e(Ie),{class:"mr-2 h-4 w-4"}),u(" "+i(e(d)("back")),1)]),_:1})]),default:n(()=>[r("div",je,[r("form",{onSubmit:s[10]||(s[10]=se(()=>{},["prevent"])),class:"grid gap-5 lg:grid-cols-12 lg:gap-7"},[r("div",Ne,[r("div",qe,[t(e(_),{class:"text-sm font-semibold text-foreground"},{default:n(()=>[u(i(e(d)("whoIsItFrom")),1)]),_:1}),t(e(ce),{modelValue:e(o).vendor_id,"onUpdate:modelValue":s[1]||(s[1]=l=>e(o).vendor_id=l),"entity-type":"vendor",placeholder:e(d)("searchVendors"),onEntitySelected:Q,onQuickAddClick:s[2]||(s[2]=l=>g.value=!0),error:e(o).errors.vendor_id},null,8,["modelValue","placeholder","error"])]),r("div",Be,[r("div",Pe,[t(e(_),{class:"text-sm font-semibold text-foreground"},{default:n(()=>[u(i(e(d)("whatDidYouBuy")),1)]),_:1}),t(e(b),{type:"button",variant:"ghost",size:"sm",class:"-mr-2",onClick:H},{default:n(()=>[t(e(Se),{class:"h-4 w-4"}),u(" "+i(e(d)("addLine")),1)]),_:1})]),r("div",Fe,[(p(!0),x($,null,D(e(o).line_items,(l,m)=>(p(),x("div",{key:m,class:"rounded-xl border border-border/70 bg-muted/10 p-3"},[r("div",Qe,[r("div",ze,i(e(j)("itemNumber",{number:m+1})),1),e(o).line_items.length>1?(p(),I(e(b),{key:0,type:"button",variant:"ghost",size:"icon",class:"h-8 w-8 text-muted-foreground hover:text-foreground",onClick:y=>J(m)},{default:n(()=>[t(e(Ae),{class:"h-4 w-4"})]),_:1},8,["onClick"])):C("",!0)]),r("div",Le,[r("div",Me,[t(e(L),{modelValue:l.description,"onUpdate:modelValue":y=>l.description=y,placeholder:e(d)("billDescriptionPlaceholder"),rows:"2"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),r("div",Ee,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("howMuch")),1)]),_:1}),t(e(me),{modelValue:l.unit_price,"onUpdate:modelValue":y=>l.unit_price=y,currency:U.company.base_currency,size:m===0?"lg":"md"},null,8,["modelValue","onUpdate:modelValue","currency","size"])])]),r("div",Oe,[r("div",Re,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[...s[12]||(s[12]=[u("Qty",-1)])]),_:1}),t(e(k),{modelValue:l.quantity,"onUpdate:modelValue":y=>l.quantity=y,modelModifiers:{number:!0},type:"number",min:"0.01",step:"0.01",class:"h-9 w-24"},null,8,["modelValue","onUpdate:modelValue"])]),m===0?(p(),x("div",Ke,[t(e(pe),{modelValue:e(o).apply_tax,"onUpdate:modelValue":s[3]||(s[3]=y=>e(o).apply_tax=y),"entity-type":"vendor","entity-id":e(o).vendor_id,onTaxCodeResolved:Y},null,8,["modelValue","entity-id"])])):C("",!0)])]))),128))])]),r("div",Ye,[t(e(_),{class:"text-sm font-semibold text-foreground"},{default:n(()=>[u(i(e(d)("expenseCategory")),1)]),_:1}),t(e(he),{modelValue:e(o).account_id,"onUpdate:modelValue":G},{default:n(()=>[t(e(we),{class:z({"border-destructive":e(o).errors.account_id})},{default:n(()=>[t(e(Ve),{placeholder:e(d)("selectCategory")},null,8,["placeholder"])]),_:1},8,["class"]),t(e($e),null,{default:n(()=>[(p(!0),x($,null,D(E.value,l=>(p(),I(e(ke),{key:l.label},{default:n(()=>[t(e(Ue),null,{default:n(()=>[u(i(l.label),1)]),_:2},1024),(p(!0),x($,null,D(l.accounts,m=>(p(),I(e(Ce),{key:m.id,value:m.id},{default:n(()=>[u(i(m.code)+" - "+i(m.name),1)]),_:2},1032,["value"]))),128))]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"]),e(o).errors.account_id?(p(),x("p",Ge,i(e(o).errors.account_id),1)):C("",!0)]),r("div",He,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("dueIn")),1)]),_:1}),t(e(_e),{modelValue:e(o).due_date,"onUpdate:modelValue":s[4]||(s[4]=l=>e(o).due_date=l),"invoice-date":e(o).bill_date,"default-terms":h.value,error:e(o).errors.due_date},null,8,["modelValue","invoice-date","default-terms","error"])]),t(e(ye),{class:"opacity-60"}),t(e(le),{open:S.value,"onUpdate:open":s[9]||(s[9]=l=>S.value=l)},{default:n(()=>[t(e(re),{class:"flex w-full items-center justify-between rounded-lg border border-border/70 bg-muted/30 px-3 py-2 text-sm text-muted-foreground transition-colors hover:bg-muted/50 hover:text-foreground"},{default:n(()=>[r("span",null,i(e(d)("addMoreDetails")),1),t(e(ne),{class:z(["h-4 w-4 transition-transform",{"rotate-90":S.value}])},null,8,["class"])]),_:1}),t(e(de),{class:"mt-4 space-y-4"},{default:n(()=>[r("div",Je,[r("div",We,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("billDate")),1)]),_:1}),t(e(k),{type:"date",modelValue:e(o).bill_date,"onUpdate:modelValue":s[5]||(s[5]=l=>e(o).bill_date=l)},null,8,["modelValue"])]),r("div",Xe,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("vendorInvoiceNumber")),1)]),_:1}),t(e(k),{modelValue:e(o).bill_number,"onUpdate:modelValue":s[6]||(s[6]=l=>e(o).bill_number=l),placeholder:e(d)("vendorInvoiceNumberPlaceholder")},null,8,["modelValue","placeholder"])])]),r("div",Ze,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("reference")),1)]),_:1}),t(e(k),{modelValue:e(o).reference,"onUpdate:modelValue":s[7]||(s[7]=l=>e(o).reference=l),placeholder:e(d)("referencePlaceholder")},null,8,["modelValue","placeholder"])]),r("div",et,[t(e(_),{class:"text-xs font-medium text-muted-foreground"},{default:n(()=>[u(i(e(d)("internalNotes")),1)]),_:1}),t(e(L),{modelValue:e(o).notes,"onUpdate:modelValue":s[8]||(s[8]=l=>e(o).notes=l),placeholder:e(d)("internalNotesPlaceholder"),rows:"2"},null,8,["modelValue","placeholder"])])]),_:1})]),_:1},8,["open"])]),r("div",tt,[t(e(ve),{class:"lg:sticky lg:top-20 overflow-hidden"},{default:n(()=>[t(e(be),{class:"space-y-1 pb-3"},{default:n(()=>[t(e(ge),{class:"text-xs font-medium tracking-wide text-muted-foreground uppercase"},{default:n(()=>[u(i(e(d)("total")),1)]),_:1}),r("div",st,i(T(O.value)),1)]),_:1}),t(e(xe),{class:"space-y-3"},{default:n(()=>[r("div",ot,[r("div",at,[r("span",lt,i(e(d)("subtotal")),1),r("span",rt,i(T(A.value)),1)]),e(o).apply_tax&&f.value?(p(),x("div",nt,[r("span",dt,i(e(d)("tax"))+" ("+i(f.value.rate)+"%)",1),r("span",it,i(T(F.value)),1)])):C("",!0)]),r("div",ut,[t(e(b),{type:"button",onClick:X,disabled:e(o).processing||!R.value,size:"lg",class:"w-full bg-gradient-to-r from-teal-600 to-emerald-600 text-white shadow-md shadow-teal-600/20 hover:from-teal-700 hover:to-emerald-700 disabled:opacity-50"},{default:n(()=>[t(e(Te),{class:"mr-2 h-4 w-4"}),u(" "+i(e(d)("saveAndPayNow")),1)]),_:1},8,["disabled"]),t(e(b),{type:"button",variant:"ghost",onClick:W,disabled:e(o).processing,class:"w-full"},{default:n(()=>[t(e(De),{class:"mr-2 h-4 w-4"}),u(" "+i(e(d)("saveDraft")),1)]),_:1},8,["disabled"])]),r("p",ct,i(e(j)("dueInDays",{days:h.value})),1)]),_:1})]),_:1})])],32)]),t(e(fe),{open:g.value,"onUpdate:open":s[11]||(s[11]=l=>g.value=l),"entity-type":"vendor",onCreated:K},null,8,["open"])]),_:1},8,["title","breadcrumbs"])],64))}});export{us as default};
