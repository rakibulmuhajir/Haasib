import{d as M,s as j,x as P,c as _,a as l,u as e,h as z,w as d,j as C,b as n,e as i,t as r,f as R,o as m,y as G,F as y,r as w,i as B}from"./app-B-wLZQl0.js";import{_ as H}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as F}from"./index-D8JUok4n.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as O}from"./Textarea.vue_vue_type_script_setup_true_lang-DrbQ2zws.js";import{_ as k,a as S,b as N,c as U,d as x}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as p,a as v}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as A}from"./CardDescription.vue_vue_type_script_setup_true_lang-D23jLuEj.js";import{_ as g}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{_ as T}from"./index-a73qSWOM.js";import{R as J}from"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import{A as K}from"./arrow-left-DSX0n2_N.js";import{S as Q}from"./save-CBmuHaqJ.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./loader-circle-BSwxCoSE.js";import"./createLucideIcon-CbxkoCx6.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./useForwardExpose-Ca12vFmR.js";import"./VisuallyHidden-BZkMfMV2.js";import"./Collection-DN_gmv-a.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./check-DogY6QNG.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./nullish-CHIgUVhi.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./plus-C63jdNg7.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./file-text-CFHWSPvd.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";const W={class:"flex items-center justify-between"},X={class:"flex items-center gap-2 mb-2"},Y={class:"text-right"},Z={class:"text-2xl font-bold text-green-600"},h={class:"text-sm text-muted-foreground"},ee={key:0,class:"mb-6"},te={class:"flex items-center"},le={key:0,class:"text-sm text-muted-foreground mt-1"},de={key:1,class:"text-sm text-muted-foreground mt-1"},oe={class:"text-sm text-muted-foreground mt-1"},se={class:"flex justify-between"},ne={class:"font-bold text-green-600"},ie={class:"flex justify-between text-sm text-muted-foreground"},ae={class:"flex justify-between text-sm text-muted-foreground"},re={key:0,class:"flex justify-between text-sm text-muted-foreground"},ue={class:"flex justify-between text-sm text-muted-foreground"},me={key:0},fe={key:1},Ye=M({__name:"Edit",props:{company:{},credit_note:{},customers:{},invoices:{},currencies:{}},setup(u){const a=u,L=j(()=>[{title:"Dashboard",href:"/dashboard"},{title:a.company.name,href:`/${a.company.slug}`},{title:"Credit Notes",href:`/${a.company.slug}/credit-notes`},{title:a.credit_note.credit_note_number,href:`/${a.company.slug}/credit-notes/${a.credit_note.id}`},{title:"Edit"}]),s=P({customer_id:a.credit_note.customer.id,invoice_id:a.credit_note.invoice?.id||"company_default",amount:a.credit_note.amount,base_currency:a.credit_note.base_currency,reason:a.credit_note.reason,status:a.credit_note.status,credit_date:a.credit_note.credit_date,notes:a.credit_note.notes||"",terms:a.credit_note.terms||""}),I=j(()=>s.customer_id?a.invoices.filter(b=>b.customer_id===s.customer_id):[]),q=[{value:"draft",label:"Draft"},{value:"issued",label:"Issued"},{value:"partial",label:"Partially Applied"},{value:"applied",label:"Applied"},{value:"void",label:"Void"}],$=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:s.base_currency||"USD"}).format(b),D=()=>{({...s},s.transform(b=>{const t={...b};return t.invoice_id==="company_default"&&(t.invoice_id=null),t}).put(`/${a.company.slug}/credit-notes/${a.credit_note.id}`))},f=j(()=>["draft","issued"].includes(a.credit_note.status));return(b,t)=>(m(),_(y,null,[l(e(z),{title:`Edit Credit Note ${u.credit_note.credit_note_number}`},null,8,["title"]),l(H,{title:"Edit Credit Note",breadcrumbs:L.value},{actions:d(()=>[l(e(F),{variant:"outline",onClick:t[0]||(t[0]=o=>e(R).get(`/${u.company.slug}/credit-notes/${u.credit_note.id}`))},{default:d(()=>[l(e(K),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=i(" Cancel ",-1))]),_:1}),l(e(F),{onClick:D,disabled:e(s).processing||!f.value},{default:d(()=>[l(e(Q),{class:"mr-2 h-4 w-4"}),t[13]||(t[13]=i(" Save Changes ",-1))]),_:1},8,["disabled"])]),default:d(()=>[l(e(p),{class:"mb-6"},{default:d(()=>[l(e(v),{class:"pt-6"},{default:d(()=>[n("div",W,[n("div",null,[n("div",X,[l(e(J),{class:"h-5 w-5 text-muted-foreground"}),t[14]||(t[14]=n("span",{class:"text-sm font-medium text-muted-foreground"},"Credit Note",-1)),l(e(T),{variant:u.credit_note.status==="applied"?"default":"secondary"},{default:d(()=>[i(r(u.credit_note.status),1)]),_:1},8,["variant"])]),n("button",{onClick:t[1]||(t[1]=o=>e(R).get(`/${u.company.slug}/credit-notes/${u.credit_note.id}`)),class:"text-2xl font-bold hover:text-primary transition-colors"},r(u.credit_note.credit_note_number),1)]),n("div",Y,[n("div",Z,r($(u.credit_note.amount)),1),n("div",h,r(u.credit_note.base_currency),1)])])]),_:1})]),_:1}),f.value?C("",!0):(m(),_("div",ee,[l(e(p),{class:"border-yellow-200 bg-yellow-50"},{default:d(()=>[l(e(v),{class:"pt-6"},{default:d(()=>[n("div",te,[l(e(T),{variant:"secondary",class:"mr-2"},{default:d(()=>[i(r(u.credit_note.status),1)]),_:1}),t[15]||(t[15]=n("span",{class:"text-sm"},"This credit note cannot be edited in its current status.",-1))])]),_:1})]),_:1})])),n("form",{onSubmit:G(D,["prevent"]),class:"space-y-6"},[l(e(p),null,{default:d(()=>[l(e(g),null,{default:d(()=>[l(e(V),null,{default:d(()=>[...t[16]||(t[16]=[i("Customer Information",-1)])]),_:1}),l(e(A),null,{default:d(()=>[...t[17]||(t[17]=[i("Select the customer for this credit note",-1)])]),_:1})]),_:1}),l(e(v),{class:"space-y-4"},{default:d(()=>[n("div",null,[l(e(c),{for:"customer_id"},{default:d(()=>[...t[18]||(t[18]=[i("Customer *",-1)])]),_:1}),l(e(k),{modelValue:e(s).customer_id,"onUpdate:modelValue":[t[2]||(t[2]=o=>e(s).customer_id=o),t[3]||(t[3]=o=>e(s).invoice_id="company_default")],required:"",disabled:!f.value},{default:d(()=>[l(e(S),null,{default:d(()=>[l(e(N),{placeholder:"Select a customer"})]),_:1}),l(e(U),null,{default:d(()=>[(m(!0),_(y,null,w(u.customers,o=>(m(),B(e(x),{key:o.id,value:o.id},{default:d(()=>[i(r(o.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"])]),n("div",null,[l(e(c),{for:"invoice_id"},{default:d(()=>[...t[19]||(t[19]=[i("Apply to Invoice (Optional)",-1)])]),_:1}),l(e(k),{modelValue:e(s).invoice_id,"onUpdate:modelValue":t[4]||(t[4]=o=>e(s).invoice_id=o),disabled:!f.value||!e(s).customer_id},{default:d(()=>[l(e(S),null,{default:d(()=>[l(e(N),{placeholder:"Select an invoice"})]),_:1}),l(e(U),null,{default:d(()=>[l(e(x),{value:"company_default"},{default:d(()=>[...t[20]||(t[20]=[i("No specific invoice",-1)])]),_:1}),(m(!0),_(y,null,w(I.value,o=>(m(),B(e(x),{key:o.id,value:o.id},{default:d(()=>[i(r(o.invoice_number)+" - "+r($(o.total_amount))+" "+r(o.currency),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),e(s).customer_id&&I.value.length===0?(m(),_("p",le," No invoices found for this customer ")):C("",!0),e(s).customer_id?C("",!0):(m(),_("p",de," Select a customer first to see available invoices "))])]),_:1})]),_:1}),l(e(p),null,{default:d(()=>[l(e(g),null,{default:d(()=>[l(e(V),null,{default:d(()=>[...t[21]||(t[21]=[i("Credit Note Details",-1)])]),_:1}),l(e(A),null,{default:d(()=>[...t[22]||(t[22]=[i("Basic information about the credit note",-1)])]),_:1})]),_:1}),l(e(v),{class:"grid grid-cols-1 md:grid-cols-2 gap-4"},{default:d(()=>[n("div",null,[l(e(c),{for:"amount"},{default:d(()=>[...t[23]||(t[23]=[i("Amount *",-1)])]),_:1}),l(e(E),{id:"amount",modelValue:e(s).amount,"onUpdate:modelValue":t[5]||(t[5]=o=>e(s).amount=o),modelModifiers:{number:!0},type:"number",min:"0.01",step:"0.01",placeholder:"0.00",required:"",disabled:!f.value},null,8,["modelValue","disabled"]),n("p",oe,r($(e(s).amount)),1)]),n("div",null,[l(e(c),{for:"credit_date"},{default:d(()=>[...t[24]||(t[24]=[i("Credit Date *",-1)])]),_:1}),l(e(E),{id:"credit_date",modelValue:e(s).credit_date,"onUpdate:modelValue":t[6]||(t[6]=o=>e(s).credit_date=o),type:"date",required:"",disabled:!f.value},null,8,["modelValue","disabled"])]),n("div",null,[l(e(c),{for:"status"},{default:d(()=>[...t[25]||(t[25]=[i("Status *",-1)])]),_:1}),l(e(k),{modelValue:e(s).status,"onUpdate:modelValue":t[7]||(t[7]=o=>e(s).status=o),required:"",disabled:!f.value},{default:d(()=>[l(e(S),null,{default:d(()=>[l(e(N),{placeholder:"Select status"})]),_:1}),l(e(U),null,{default:d(()=>[(m(),_(y,null,w(q,o=>l(e(x),{key:o.value,value:o.value},{default:d(()=>[i(r(o.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue","disabled"])]),n("div",null,[l(e(c),{for:"base_currency"},{default:d(()=>[...t[26]||(t[26]=[i("Currency *",-1)])]),_:1}),l(e(k),{modelValue:e(s).base_currency,"onUpdate:modelValue":t[8]||(t[8]=o=>e(s).base_currency=o),required:"",disabled:!f.value},{default:d(()=>[l(e(S),null,{default:d(()=>[l(e(N),{placeholder:"Select currency"})]),_:1}),l(e(U),null,{default:d(()=>[(m(!0),_(y,null,w(u.currencies,o=>(m(),B(e(x),{key:o.currency_code,value:o.currency_code},{default:d(()=>[i(r(o.currency_code)+r(o.is_base?" (Base)":""),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"])])]),_:1})]),_:1}),l(e(p),null,{default:d(()=>[l(e(g),null,{default:d(()=>[l(e(V),null,{default:d(()=>[...t[27]||(t[27]=[i("Reason for Credit",-1)])]),_:1}),l(e(A),null,{default:d(()=>[...t[28]||(t[28]=[i("Explain why this credit note is being issued",-1)])]),_:1})]),_:1}),l(e(v),null,{default:d(()=>[n("div",null,[l(e(c),{for:"reason"},{default:d(()=>[...t[29]||(t[29]=[i("Reason *",-1)])]),_:1}),l(e(E),{id:"reason",modelValue:e(s).reason,"onUpdate:modelValue":t[9]||(t[9]=o=>e(s).reason=o),placeholder:"e.g., Product return, Service discount, Billing error",required:"",disabled:!f.value},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),l(e(p),null,{default:d(()=>[l(e(g),null,{default:d(()=>[l(e(V),null,{default:d(()=>[...t[30]||(t[30]=[i("Additional Information",-1)])]),_:1}),l(e(A),null,{default:d(()=>[...t[31]||(t[31]=[i("Optional terms and notes",-1)])]),_:1})]),_:1}),l(e(v),{class:"space-y-4"},{default:d(()=>[n("div",null,[l(e(c),{for:"terms"},{default:d(()=>[...t[32]||(t[32]=[i("Terms",-1)])]),_:1}),l(e(O),{id:"terms",modelValue:e(s).terms,"onUpdate:modelValue":t[10]||(t[10]=o=>e(s).terms=o),placeholder:"Credit note terms and conditions...",rows:"3",disabled:!f.value},null,8,["modelValue","disabled"])]),n("div",null,[l(e(c),{for:"notes"},{default:d(()=>[...t[33]||(t[33]=[i("Internal Notes",-1)])]),_:1}),l(e(O),{id:"notes",modelValue:e(s).notes,"onUpdate:modelValue":t[11]||(t[11]=o=>e(s).notes=o),placeholder:"Internal notes about this credit note...",rows:"3",disabled:!f.value},null,8,["modelValue","disabled"])])]),_:1})]),_:1}),l(e(p),null,{default:d(()=>[l(e(g),null,{default:d(()=>[l(e(V),null,{default:d(()=>[...t[34]||(t[34]=[i("Credit Note Summary",-1)])]),_:1})]),_:1}),l(e(v),{class:"space-y-3"},{default:d(()=>[n("div",se,[t[35]||(t[35]=n("span",null,"Credit Amount:",-1)),n("span",ne,r($(e(s).amount)),1)]),n("div",ie,[t[36]||(t[36]=n("span",null,"Customer:",-1)),n("span",null,r(u.customers.find(o=>o.id===e(s).customer_id)?.name||u.credit_note.customer.name),1)]),n("div",ae,[t[37]||(t[37]=n("span",null,"Status:",-1)),n("span",null,r(q.find(o=>o.value===e(s).status)?.label),1)]),e(s).reason?(m(),_("div",re,[t[38]||(t[38]=n("span",null,"Reason:",-1)),n("span",null,r(e(s).reason),1)])):C("",!0),n("div",ue,[t[39]||(t[39]=n("span",null,"Applied to:",-1)),e(s).invoice_id==="company_default"?(m(),_("span",me,"No specific invoice")):(m(),_("span",fe,r(I.value.find(o=>o.id===e(s).invoice_id)?.invoice_number||u.credit_note.invoice?.invoice_number||"Unknown invoice"),1))])]),_:1})]),_:1})],32)]),_:1},8,["breadcrumbs"])],64))}});export{Ye as default};
