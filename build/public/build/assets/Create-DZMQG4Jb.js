import{d as Q,x as G,K as M,s as H,c as _,a as l,u as e,h as J,w as n,b as d,y as R,j as C,o as m,F as c,r as V,t as p,e as a,i as q,f as W}from"./app-B-wLZQl0.js";import{_ as X}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as $}from"./index-D8JUok4n.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as i}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as B,a as I,b as T,c as j,d as x}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as P}from"./Textarea.vue_vue_type_script_setup_true_lang-DrbQ2zws.js";import{_ as k,a as w}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as E}from"./CardDescription.vue_vue_type_script_setup_true_lang-D23jLuEj.js";import{_ as S}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{P as Y}from"./plus-C63jdNg7.js";import{T as Z}from"./trash-2-BxVbfljz.js";import{A as h}from"./arrow-left-DSX0n2_N.js";import{S as ee}from"./save-CBmuHaqJ.js";import{F as te}from"./file-text-CFHWSPvd.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import"./useForwardExpose-Ca12vFmR.js";import"./VisuallyHidden-BZkMfMV2.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./Collection-DN_gmv-a.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./createLucideIcon-CbxkoCx6.js";import"./check-DogY6QNG.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";import"./loader-circle-BSwxCoSE.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./index-a73qSWOM.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./nullish-CHIgUVhi.js";const le={key:0,class:"rounded-md bg-destructive/15 p-4"},ne={class:"text-sm text-destructive"},oe={class:"list-disc list-inside mt-2"},ue={key:0,class:"text-sm text-destructive mt-1"},de={key:0,class:"text-sm text-destructive mt-1"},ae={class:"flex items-center justify-between"},re={class:"md:col-span-2"},ie={class:"flex items-end"},se={class:"space-y-2"},me={class:"flex justify-between text-sm"},pe={class:"flex justify-between text-sm"},_e={class:"flex justify-between text-sm"},fe={class:"text-destructive"},be={class:"flex justify-between text-lg font-semibold pt-2 border-t"},tt=Q({__name:"Create",props:{company:{},vendors:{},expenseAccounts:{},apAccounts:{}},setup(A){const v=A,O=[{title:"Dashboard",href:`/${v.company.slug}`},{title:"Bills",href:`/${v.company.slug}/bills`},{title:"Create"}],L=()=>({description:"",quantity:1,unit_price:0,tax_rate:0,discount_rate:0,expense_account_id:"company_default"}),o=G({vendor_id:"",bill_number:"",vendor_invoice_number:"",bill_date:new Date().toISOString().slice(0,10),due_date:"",status:"draft",currency:v.company.base_currency,base_currency:v.company.base_currency,exchange_rate:null,payment_terms:30,notes:"",internal_notes:"",ap_account_id:"company_default",line_items:[L()]});M(()=>o.vendor_id,s=>{const t=v.vendors.find(u=>u.id===s);t?.payment_terms&&(o.payment_terms=t.payment_terms)}),M([()=>o.bill_date,()=>o.payment_terms],()=>{if(o.bill_date&&o.payment_terms){const s=new Date(o.bill_date);s.setDate(s.getDate()+o.payment_terms),o.due_date=s.toISOString().slice(0,10)}});const g=H(()=>{const s=o.line_items.reduce((r,b)=>r+(Number(b.quantity)||0)*(Number(b.unit_price)||0),0),t=o.line_items.reduce((r,b)=>{const D=(Number(b.quantity)||0)*(Number(b.unit_price)||0);return r+D*((Number(b.tax_rate)||0)/100)},0),u=o.line_items.reduce((r,b)=>{const D=(Number(b.quantity)||0)*(Number(b.unit_price)||0);return r+D*((Number(b.discount_rate)||0)/100)},0),y=s+t-u;return{subtotal:s,tax:t,discount:u,total:y}}),U=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:o.currency||"USD"}).format(s),z=()=>o.line_items.push(L()),K=s=>{o.line_items.length>1&&o.line_items.splice(s,1)},F=()=>{const s={...o.data(),ap_account_id:o.ap_account_id==="company_default"?null:o.ap_account_id,line_items:o.line_items.map(t=>({...t,expense_account_id:t.expense_account_id==="company_default"?null:t.expense_account_id}))};o.transform(()=>s).post(`/${v.company.slug}/bills`,{preserveScroll:!0})};return(s,t)=>(m(),_(c,null,[l(e(J),{title:"Create Bill"}),l(X,{title:"Create Bill",breadcrumbs:O,icon:e(te)},{actions:n(()=>[l(e($),{variant:"outline",onClick:t[0]||(t[0]=u=>e(W).get(`/${A.company.slug}/bills`))},{default:n(()=>[l(e(h),{class:"mr-2 h-4 w-4"}),t[11]||(t[11]=a(" Back ",-1))]),_:1}),l(e($),{onClick:F,disabled:e(o).processing},{default:n(()=>[l(e(ee),{class:"mr-2 h-4 w-4"}),t[12]||(t[12]=a(" Save Bill ",-1))]),_:1},8,["disabled"])]),default:n(()=>[d("form",{class:"space-y-6",onSubmit:R(F,["prevent"])},[Object.keys(e(o).errors).length>0?(m(),_("div",le,[d("div",ne,[t[13]||(t[13]=d("p",{class:"font-medium"},"Please fix the following errors:",-1)),d("ul",oe,[(m(!0),_(c,null,V(e(o).errors,(u,y)=>(m(),_("li",{key:y},p(u),1))),128))])])])):C("",!0),l(e(k),null,{default:n(()=>[l(e(S),null,{default:n(()=>[l(e(N),null,{default:n(()=>[...t[14]||(t[14]=[a("Bill Information",-1)])]),_:1}),l(e(E),null,{default:n(()=>[...t[15]||(t[15]=[a("Enter the basic bill details",-1)])]),_:1})]),_:1}),l(e(w),{class:"grid grid-cols-1 md:grid-cols-2 gap-4"},{default:n(()=>[d("div",null,[l(e(i),{for:"vendor_id"},{default:n(()=>[...t[16]||(t[16]=[a("Vendor *",-1)])]),_:1}),l(e(B),{modelValue:e(o).vendor_id,"onUpdate:modelValue":t[1]||(t[1]=u=>e(o).vendor_id=u),required:""},{default:n(()=>[l(e(I),{id:"vendor_id"},{default:n(()=>[l(e(T),{placeholder:"Select a vendor"})]),_:1}),l(e(j),null,{default:n(()=>[(m(!0),_(c,null,V(A.vendors,u=>(m(),q(e(x),{key:u.id,value:u.id},{default:n(()=>[a(p(u.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(o).errors.vendor_id?(m(),_("p",ue,p(e(o).errors.vendor_id),1)):C("",!0)]),d("div",null,[l(e(i),{for:"bill_number"},{default:n(()=>[...t[17]||(t[17]=[a("Bill Number",-1)])]),_:1}),l(e(f),{id:"bill_number",modelValue:e(o).bill_number,"onUpdate:modelValue":t[2]||(t[2]=u=>e(o).bill_number=u),placeholder:"Auto-generated if left blank"},null,8,["modelValue"]),t[18]||(t[18]=d("p",{class:"text-xs text-muted-foreground mt-1"},"Leave blank to auto-generate",-1)),e(o).errors.bill_number?(m(),_("p",de,p(e(o).errors.bill_number),1)):C("",!0)]),d("div",null,[l(e(i),{for:"vendor_invoice_number"},{default:n(()=>[...t[19]||(t[19]=[a("Vendor Invoice Number",-1)])]),_:1}),l(e(f),{id:"vendor_invoice_number",modelValue:e(o).vendor_invoice_number,"onUpdate:modelValue":t[3]||(t[3]=u=>e(o).vendor_invoice_number=u),placeholder:"Vendor's invoice #"},null,8,["modelValue"])]),d("div",null,[l(e(i),{for:"bill_date"},{default:n(()=>[...t[20]||(t[20]=[a("Bill Date *",-1)])]),_:1}),l(e(f),{id:"bill_date",modelValue:e(o).bill_date,"onUpdate:modelValue":t[4]||(t[4]=u=>e(o).bill_date=u),type:"date",required:""},null,8,["modelValue"])]),d("div",null,[l(e(i),{for:"payment_terms"},{default:n(()=>[...t[21]||(t[21]=[a("Payment Terms (days) *",-1)])]),_:1}),l(e(f),{id:"payment_terms",modelValue:e(o).payment_terms,"onUpdate:modelValue":t[5]||(t[5]=u=>e(o).payment_terms=u),modelModifiers:{number:!0},type:"number",min:"0",max:"365",required:""},null,8,["modelValue"])]),d("div",null,[l(e(i),{for:"due_date"},{default:n(()=>[...t[22]||(t[22]=[a("Due Date",-1)])]),_:1}),l(e(f),{id:"due_date",modelValue:e(o).due_date,"onUpdate:modelValue":t[6]||(t[6]=u=>e(o).due_date=u),type:"date"},null,8,["modelValue"]),t[23]||(t[23]=d("p",{class:"text-xs text-muted-foreground mt-1"},"Auto-calculated from payment terms",-1))]),d("div",null,[l(e(i),{for:"currency"},{default:n(()=>[...t[24]||(t[24]=[a("Currency *",-1)])]),_:1}),l(e(f),{id:"currency",modelValue:e(o).currency,"onUpdate:modelValue":t[7]||(t[7]=u=>e(o).currency=u),maxlength:"3",placeholder:"USD",required:""},null,8,["modelValue"])]),d("div",null,[l(e(i),{for:"ap_account_id"},{default:n(()=>[...t[25]||(t[25]=[a("AP Account",-1)])]),_:1}),l(e(B),{modelValue:e(o).ap_account_id,"onUpdate:modelValue":t[8]||(t[8]=u=>e(o).ap_account_id=u)},{default:n(()=>[l(e(I),{id:"ap_account_id"},{default:n(()=>[l(e(T),{placeholder:"Use company default"})]),_:1}),l(e(j),null,{default:n(()=>[l(e(x),{value:"company_default"},{default:n(()=>[...t[26]||(t[26]=[a("Use company default",-1)])]),_:1}),(m(!0),_(c,null,V(v.apAccounts||[],u=>(m(),q(e(x),{key:u.id,value:u.id},{default:n(()=>[a(p(u.code)+" — "+p(u.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),l(e(k),null,{default:n(()=>[l(e(S),null,{default:n(()=>[d("div",ae,[d("div",null,[l(e(N),null,{default:n(()=>[...t[27]||(t[27]=[a("Line Items",-1)])]),_:1}),l(e(E),null,{default:n(()=>[...t[28]||(t[28]=[a("Add items to this bill",-1)])]),_:1})]),l(e($),{type:"button",variant:"outline",onClick:z},{default:n(()=>[l(e(Y),{class:"mr-2 h-4 w-4"}),t[29]||(t[29]=a(" Add Line ",-1))]),_:1})])]),_:1}),l(e(w),{class:"space-y-4"},{default:n(()=>[(m(!0),_(c,null,V(e(o).line_items,(u,y)=>(m(),_("div",{key:y,class:"grid gap-3 rounded-lg border p-4 md:grid-cols-7"},[d("div",re,[l(e(i),null,{default:n(()=>[...t[30]||(t[30]=[a("Description *",-1)])]),_:1}),l(e(f),{modelValue:u.description,"onUpdate:modelValue":r=>u.description=r,placeholder:"Item description",required:""},null,8,["modelValue","onUpdate:modelValue"])]),d("div",null,[l(e(i),null,{default:n(()=>[...t[31]||(t[31]=[a("Quantity *",-1)])]),_:1}),l(e(f),{modelValue:u.quantity,"onUpdate:modelValue":r=>u.quantity=r,modelModifiers:{number:!0},type:"number",min:"0.01",step:"0.01",required:""},null,8,["modelValue","onUpdate:modelValue"])]),d("div",null,[l(e(i),null,{default:n(()=>[...t[32]||(t[32]=[a("Unit Price *",-1)])]),_:1}),l(e(f),{modelValue:u.unit_price,"onUpdate:modelValue":r=>u.unit_price=r,modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",required:""},null,8,["modelValue","onUpdate:modelValue"])]),d("div",null,[l(e(i),null,{default:n(()=>[...t[33]||(t[33]=[a("Tax %",-1)])]),_:1}),l(e(f),{modelValue:u.tax_rate,"onUpdate:modelValue":r=>u.tax_rate=r,modelModifiers:{number:!0},type:"number",min:"0",max:"100",step:"0.01",placeholder:"0"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",null,[l(e(i),null,{default:n(()=>[...t[34]||(t[34]=[a("Discount %",-1)])]),_:1}),l(e(f),{modelValue:u.discount_rate,"onUpdate:modelValue":r=>u.discount_rate=r,modelModifiers:{number:!0},type:"number",min:"0",max:"100",step:"0.01",placeholder:"0"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",null,[l(e(i),null,{default:n(()=>[...t[35]||(t[35]=[a("Expense Account",-1)])]),_:1}),l(e(B),{modelValue:u.expense_account_id,"onUpdate:modelValue":r=>u.expense_account_id=r},{default:n(()=>[l(e(I),null,{default:n(()=>[l(e(T),{placeholder:"Select account"})]),_:1}),l(e(j),null,{default:n(()=>[l(e(x),{value:"company_default"},{default:n(()=>[...t[36]||(t[36]=[a("Use default",-1)])]),_:1}),(m(!0),_(c,null,V(v.expenseAccounts||[],r=>(m(),q(e(x),{key:r.id,value:r.id},{default:n(()=>[a(p(r.code)+" — "+p(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),d("div",ie,[l(e($),{type:"button",variant:"destructive",size:"icon",onClick:r=>K(y),disabled:e(o).line_items.length===1},{default:n(()=>[l(e(Z),{class:"h-4 w-4"})]),_:1},8,["onClick","disabled"])])]))),128))]),_:1})]),_:1}),l(e(k),null,{default:n(()=>[l(e(S),null,{default:n(()=>[l(e(N),null,{default:n(()=>[...t[37]||(t[37]=[a("Bill Summary",-1)])]),_:1})]),_:1}),l(e(w),null,{default:n(()=>[d("div",se,[d("div",me,[t[38]||(t[38]=d("span",null,"Subtotal:",-1)),d("span",null,p(U(g.value.subtotal)),1)]),d("div",pe,[t[39]||(t[39]=d("span",null,"Tax:",-1)),d("span",null,p(U(g.value.tax)),1)]),d("div",_e,[t[40]||(t[40]=d("span",null,"Discount:",-1)),d("span",fe,"-"+p(U(g.value.discount)),1)]),d("div",be,[t[41]||(t[41]=d("span",null,"Total:",-1)),d("span",null,p(U(g.value.total)),1)])])]),_:1})]),_:1}),l(e(k),null,{default:n(()=>[l(e(S),null,{default:n(()=>[l(e(N),null,{default:n(()=>[...t[42]||(t[42]=[a("Additional Information",-1)])]),_:1})]),_:1}),l(e(w),{class:"space-y-4"},{default:n(()=>[d("div",null,[l(e(i),{for:"notes"},{default:n(()=>[...t[43]||(t[43]=[a("Notes (visible to vendor)",-1)])]),_:1}),l(e(P),{id:"notes",modelValue:e(o).notes,"onUpdate:modelValue":t[9]||(t[9]=u=>e(o).notes=u),placeholder:"Any notes about this bill...",rows:"3"},null,8,["modelValue"])]),d("div",null,[l(e(i),{for:"internal_notes"},{default:n(()=>[...t[44]||(t[44]=[a("Internal Notes (private)",-1)])]),_:1}),l(e(P),{id:"internal_notes",modelValue:e(o).internal_notes,"onUpdate:modelValue":t[10]||(t[10]=u=>e(o).internal_notes=u),placeholder:"Internal notes (not visible to vendor)...",rows:"3"},null,8,["modelValue"])])]),_:1})]),_:1})],32)]),_:1},8,["icon"])],64))}});export{tt as default};
