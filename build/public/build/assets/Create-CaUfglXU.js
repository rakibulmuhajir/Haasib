import{d as z,q as P,x as G,s as X,c as f,a as l,u as e,h as H,w as a,b as u,y as J,e as s,o as i,F as y,r as k,i as S,t as V,j as K,f as E}from"./app-B-wLZQl0.js";import{_ as Q}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{_ as B}from"./index-D8JUok4n.js";import{_ as C}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as Y}from"./Checkbox.vue_vue_type_script_setup_true_lang-yNvHsWJi.js";import{_ as w,a as U,b as A,c as x,d as c}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as T,a as N}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as R}from"./CardDescription.vue_vue_type_script_setup_true_lang-D23jLuEj.js";import{_ as F}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as j}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{T as Z}from"./trash-2-BxVbfljz.js";import{P as h}from"./plus-C63jdNg7.js";import{X as ee,W as te}from"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import{S as le}from"./save-CBmuHaqJ.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./loader-circle-BSwxCoSE.js";import"./createLucideIcon-CbxkoCx6.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./useForwardExpose-Ca12vFmR.js";import"./index-a73qSWOM.js";import"./VisuallyHidden-BZkMfMV2.js";import"./nullish-CHIgUVhi.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./Collection-DN_gmv-a.js";import"./RovingFocusItem-PDr5bOed.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";import"./check-DogY6QNG.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./building-2-DLYGST8U.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./file-text-CFHWSPvd.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";const ae={class:"grid gap-4 md:grid-cols-2"},oe={class:"space-y-2"},se={class:"space-y-2"},ue={class:"space-y-2"},ne={class:"flex items-center gap-3 pt-6"},ie={class:"flex-1 grid gap-3 md:grid-cols-3"},de={class:"space-y-2"},re={class:"space-y-2"},me={class:"space-y-2"},pe={class:"grid gap-4 md:grid-cols-2"},fe={class:"space-y-2"},_e={class:"space-y-2"},ce={class:"space-y-2"},ve={class:"space-y-2"},ye={key:0,class:"text-sm text-amber-600"},be={class:"flex justify-end gap-3"},b="__none",ot=z({__name:"Create",props:{company:{},bankAccounts:{},glAccounts:{},nextPriority:{},conditionFields:{},conditionOperators:{},actionTypes:{}},setup($){const v=$,L=[{title:"Dashboard",href:`/${v.company.slug}`},{title:"Banking",href:`/${v.company.slug}/banking/accounts`},{title:"Rules",href:`/${v.company.slug}/banking/rules`},{title:"Create",href:`/${v.company.slug}/banking/rules/create`}],g=P([{field:"description",operator:"contains",value:""}]),p=P({set_category:"",set_payee:"",set_gl_account_id:"",set_transaction_type:""}),d=G({name:"",bank_account_id:b,priority:v.nextPriority,is_active:!0}),O=[{value:"deposit",label:"Deposit"},{value:"withdrawal",label:"Withdrawal"},{value:"transfer",label:"Transfer"},{value:"fee",label:"Fee"},{value:"interest",label:"Interest"},{value:"adjustment",label:"Adjustment"}],q=()=>{g.value.push({field:"description",operator:"contains",value:""})},W=_=>{g.value.length>1&&g.value.splice(_,1)},D=X(()=>Object.values(p.value).some(_=>_&&_!==b)),I=()=>{const _={};for(const[o,r]of Object.entries(p.value))r&&r!==b&&(_[o]=r);const t={...d.data(),bank_account_id:d.bank_account_id===b?null:d.bank_account_id,conditions:g.value.filter(o=>o.value),actions:_};E.post(`/${v.company.slug}/banking/rules`,t,{preserveScroll:!0})},M=()=>{E.get(`/${v.company.slug}/banking/rules`)};return(_,t)=>(i(),f(y,null,[l(e(H),{title:"Create Bank Rule"}),l(Q,{title:"Create Bank Rule",breadcrumbs:L,icon:e(te)},{default:a(()=>[u("form",{class:"space-y-6 max-w-3xl",onSubmit:J(I,["prevent"])},[l(e(T),null,{default:a(()=>[l(e(F),null,{default:a(()=>[l(e(j),null,{default:a(()=>[...t[8]||(t[8]=[s("Rule Details",-1)])]),_:1}),l(e(R),null,{default:a(()=>[...t[9]||(t[9]=[s("Define when and how this rule should apply",-1)])]),_:1})]),_:1}),l(e(N),{class:"space-y-4"},{default:a(()=>[u("div",ae,[u("div",oe,[l(e(m),{for:"name"},{default:a(()=>[...t[10]||(t[10]=[s("Rule Name *",-1)])]),_:1}),l(e(C),{id:"name",modelValue:e(d).name,"onUpdate:modelValue":t[0]||(t[0]=o=>e(d).name=o),placeholder:"e.g., Utilities - Electric Bill",required:""},null,8,["modelValue"])]),u("div",se,[l(e(m),{for:"priority"},{default:a(()=>[...t[11]||(t[11]=[s("Priority *",-1)])]),_:1}),l(e(C),{id:"priority",modelValue:e(d).priority,"onUpdate:modelValue":t[1]||(t[1]=o=>e(d).priority=o),modelModifiers:{number:!0},type:"number",min:"1",required:""},null,8,["modelValue"]),t[12]||(t[12]=u("p",{class:"text-xs text-muted-foreground"},"Lower numbers run first",-1))]),u("div",ue,[l(e(m),{for:"bank_account_id"},{default:a(()=>[...t[13]||(t[13]=[s("Bank Account (optional)",-1)])]),_:1}),l(e(w),{modelValue:e(d).bank_account_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e(d).bank_account_id=o)},{default:a(()=>[l(e(U),{id:"bank_account_id"},{default:a(()=>[l(e(A),{placeholder:"All accounts"})]),_:1}),l(e(x),null,{default:a(()=>[l(e(c),{value:b},{default:a(()=>[...t[14]||(t[14]=[s("All accounts",-1)])]),_:1}),(i(!0),f(y,null,k($.bankAccounts,o=>(i(),S(e(c),{key:o.id,value:o.id},{default:a(()=>[s(V(o.account_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t[15]||(t[15]=u("p",{class:"text-xs text-muted-foreground"},"Leave blank to apply to all accounts",-1))]),u("div",ne,[l(e(Y),{id:"is_active",checked:e(d).is_active,"onUpdate:checked":t[3]||(t[3]=o=>e(d).is_active=o)},null,8,["checked"]),l(e(m),{for:"is_active",class:"cursor-pointer"},{default:a(()=>[...t[16]||(t[16]=[s(" Rule is active ",-1)])]),_:1})])])]),_:1})]),_:1}),l(e(T),null,{default:a(()=>[l(e(F),null,{default:a(()=>[l(e(j),null,{default:a(()=>[...t[17]||(t[17]=[s("Conditions",-1)])]),_:1}),l(e(R),null,{default:a(()=>[...t[18]||(t[18]=[s("Define when this rule should match (all conditions must be true)",-1)])]),_:1})]),_:1}),l(e(N),{class:"space-y-4"},{default:a(()=>[(i(!0),f(y,null,k(g.value,(o,r)=>(i(),f("div",{key:r,class:"flex items-end gap-3"},[u("div",ie,[u("div",de,[l(e(m),{for:`field-${r}`},{default:a(()=>[...t[19]||(t[19]=[s("Field",-1)])]),_:1},8,["for"]),l(e(w),{modelValue:o.field,"onUpdate:modelValue":n=>o.field=n},{default:a(()=>[l(e(U),{id:`field-${r}`},{default:a(()=>[l(e(A))]),_:1},8,["id"]),l(e(x),null,{default:a(()=>[(i(!0),f(y,null,k($.conditionFields,n=>(i(),S(e(c),{key:n.value,value:n.value},{default:a(()=>[s(V(n.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),u("div",re,[l(e(m),{for:`operator-${r}`},{default:a(()=>[...t[20]||(t[20]=[s("Operator",-1)])]),_:1},8,["for"]),l(e(w),{modelValue:o.operator,"onUpdate:modelValue":n=>o.operator=n},{default:a(()=>[l(e(U),{id:`operator-${r}`},{default:a(()=>[l(e(A))]),_:1},8,["id"]),l(e(x),null,{default:a(()=>[(i(!0),f(y,null,k($.conditionOperators,n=>(i(),S(e(c),{key:n.value,value:n.value},{default:a(()=>[s(V(n.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),u("div",me,[l(e(m),{for:`value-${r}`},{default:a(()=>[...t[21]||(t[21]=[s("Value",-1)])]),_:1},8,["for"]),l(e(C),{id:`value-${r}`,modelValue:o.value,"onUpdate:modelValue":n=>o.value=n,placeholder:"e.g., ELECTRIC"},null,8,["id","modelValue","onUpdate:modelValue"])])]),l(e(B),{type:"button",variant:"ghost",size:"icon",disabled:g.value.length===1,onClick:n=>W(r)},{default:a(()=>[l(e(Z),{class:"h-4 w-4"})]),_:1},8,["disabled","onClick"])]))),128)),l(e(B),{type:"button",variant:"outline",onClick:q},{default:a(()=>[l(e(h),{class:"mr-2 h-4 w-4"}),t[22]||(t[22]=s(" Add Condition ",-1))]),_:1})]),_:1})]),_:1}),l(e(T),null,{default:a(()=>[l(e(F),null,{default:a(()=>[l(e(j),null,{default:a(()=>[...t[23]||(t[23]=[s("Actions",-1)])]),_:1}),l(e(R),null,{default:a(()=>[...t[24]||(t[24]=[s("What to do when this rule matches",-1)])]),_:1})]),_:1}),l(e(N),{class:"space-y-4"},{default:a(()=>[u("div",pe,[u("div",fe,[l(e(m),{for:"set_category"},{default:a(()=>[...t[25]||(t[25]=[s("Set Category",-1)])]),_:1}),l(e(C),{id:"set_category",modelValue:p.value.set_category,"onUpdate:modelValue":t[4]||(t[4]=o=>p.value.set_category=o),placeholder:"e.g., Utilities"},null,8,["modelValue"])]),u("div",_e,[l(e(m),{for:"set_payee"},{default:a(()=>[...t[26]||(t[26]=[s("Set Payee Name",-1)])]),_:1}),l(e(C),{id:"set_payee",modelValue:p.value.set_payee,"onUpdate:modelValue":t[5]||(t[5]=o=>p.value.set_payee=o),placeholder:"e.g., Electric Company"},null,8,["modelValue"])]),u("div",ce,[l(e(m),{for:"set_gl_account_id"},{default:a(()=>[...t[27]||(t[27]=[s("Set GL Account",-1)])]),_:1}),l(e(w),{modelValue:p.value.set_gl_account_id,"onUpdate:modelValue":t[6]||(t[6]=o=>p.value.set_gl_account_id=o)},{default:a(()=>[l(e(U),{id:"set_gl_account_id"},{default:a(()=>[l(e(A),{placeholder:"Select account"})]),_:1}),l(e(x),null,{default:a(()=>[l(e(c),{value:b},{default:a(()=>[...t[28]||(t[28]=[s("None",-1)])]),_:1}),(i(!0),f(y,null,k($.glAccounts,o=>(i(),S(e(c),{key:o.id,value:o.id},{default:a(()=>[s(V(o.code)+" â€” "+V(o.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),u("div",ve,[l(e(m),{for:"set_transaction_type"},{default:a(()=>[...t[29]||(t[29]=[s("Set Transaction Type",-1)])]),_:1}),l(e(w),{modelValue:p.value.set_transaction_type,"onUpdate:modelValue":t[7]||(t[7]=o=>p.value.set_transaction_type=o)},{default:a(()=>[l(e(U),{id:"set_transaction_type"},{default:a(()=>[l(e(A),{placeholder:"Select type"})]),_:1}),l(e(x),null,{default:a(()=>[l(e(c),{value:b},{default:a(()=>[...t[30]||(t[30]=[s("None",-1)])]),_:1}),(i(),f(y,null,k(O,o=>l(e(c),{key:o.value,value:o.value},{default:a(()=>[s(V(o.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])]),D.value?K("",!0):(i(),f("p",ye," At least one action is required "))]),_:1})]),_:1}),u("div",be,[l(e(B),{type:"button",variant:"outline",onClick:M},{default:a(()=>[l(e(ee),{class:"mr-2 h-4 w-4"}),t[31]||(t[31]=s(" Cancel ",-1))]),_:1}),l(e(B),{type:"submit",disabled:e(d).processing||!D.value},{default:a(()=>[l(e(le),{class:"mr-2 h-4 w-4"}),t[32]||(t[32]=s(" Create Rule ",-1))]),_:1},8,["disabled"])])],32)]),_:1},8,["icon"])],64))}});export{ot as default};
