import{d as J,s as g,x as K,c as p,a as t,u as e,h as M,w as s,b as i,e as n,j as S,o as m,t as r,F as y,r as V,i as w}from"./app-B-wLZQl0.js";import{_ as Q}from"./PageShell.vue_vue_type_script_setup_true_lang-CS74Goxj.js";import{u as W}from"./AppSidebarHeader.vue_vue_type_script_setup_true_lang-DKxjvTPB.js";import{u as X}from"./useFormFeedback-CE35LO4q.js";import{_ as x}from"./index-D8JUok4n.js";import{_ as C,a as U}from"./CardContent.vue_vue_type_script_setup_true_lang-f-xi8uWj.js";import{_ as D}from"./CardHeader.vue_vue_type_script_setup_true_lang-Cn7HWfaF.js";import{_ as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXA8XANX.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-E2jwtM0f.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-By03EcqK.js";import{_ as Y}from"./Separator.vue_vue_type_script_setup_true_lang-8_dGzQCj.js";import{_ as F,a as L,b as N,c as T,d as h}from"./SelectValue.vue_vue_type_script_setup_true_lang-QDn6lJI8.js";import{_ as j}from"./SelectGroup.vue_vue_type_script_setup_true_lang-Cng8hgfl.js";import{_ as B}from"./SelectLabel.vue_vue_type_script_setup_true_lang-C2EqSPuI.js";import{P as Z}from"./plus-C63jdNg7.js";import{T as ee}from"./trash-2-BxVbfljz.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CAfRB85X.js";import"./loader-circle-BSwxCoSE.js";import"./createLucideIcon-CbxkoCx6.js";import"./info-_qQ0Rbsf.js";import"./circle-check-YKnAkXoj.js";import"./useForwardExpose-Ca12vFmR.js";import"./index-a73qSWOM.js";import"./VisuallyHidden-BZkMfMV2.js";import"./PopperContent-BDPRX1DE.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./Collection-DN_gmv-a.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-ChUfgJPy.js";import"./building-2-DLYGST8U.js";import"./check-DogY6QNG.js";import"./index-Buy61MQA.js";import"./settings-B8OaYlkV.js";import"./file-text-CFHWSPvd.js";import"./users-CkYIFvpU.js";import"./calendar-B0yi2zLg.js";import"./VisuallyHiddenInput-CgZzfdZ2.js";import"./ohash.D__AXeF1-C-E83dC9.js";import"./nullish-CHIgUVhi.js";const te={class:"mx-auto w-full max-w-4xl space-y-6"},se={class:"space-y-2"},oe={key:0,class:"text-sm text-destructive"},ae={class:"space-y-2"},le={key:0,class:"text-sm text-destructive"},ne={class:"flex items-center justify-between gap-3"},re={class:"text-sm font-medium text-muted-foreground"},ie={class:"grid gap-4 md:grid-cols-2"},de={class:"space-y-2"},ue={class:"space-y-2"},me={class:"space-y-2"},ce={class:"flex items-center justify-between"},_e={class:"text-lg font-semibold tabular-nums"},pe={class:"flex justify-end"},et=J({__name:"Create",props:{company:{},depositAccounts:{},revenueAccounts:{}},setup(v){const _=v,{t:d}=W(),{showSuccess:I,showError:E}=X(),z=g(()=>[{title:"Dashboard",href:"/dashboard"},{title:_.company.name,href:`/${_.company.slug}`},{title:d("sales"),href:`/${_.company.slug}/sales/create`},{title:d("recordSale")}]),P=g(()=>_.company.bank_account_id||_.depositAccounts?.[0]?.id||""),k=()=>({description:"",amount:null,income_account_id:""}),a=K({sale_date:new Date().toISOString().split("T")[0],deposit_account_id:P.value,line_items:[k()]}),O=g(()=>a.line_items.reduce((c,o)=>c+Number(o.amount??0),0)),R=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:_.company.base_currency||"USD"}).format(c),q=()=>{a.line_items.push(k())},G=c=>{a.line_items.length<=1||a.line_items.splice(c,1)},H=()=>{a.post(`/${_.company.slug}/sales`,{preserveScroll:!0,onSuccess:()=>I("Saved"),onError:c=>E(c)})};return(c,o)=>(m(),p(y,null,[t(e(M),{title:e(d)("recordSale")},null,8,["title"]),t(Q,{title:e(d)("recordSale"),breadcrumbs:z.value},{default:s(()=>[i("div",te,[t(e(C),null,{default:s(()=>[t(e(D),null,{default:s(()=>[t(e(A),null,{default:s(()=>[...o[2]||(o[2]=[n("Details",-1)])]),_:1})]),_:1}),t(e(U),{class:"grid gap-4 md:grid-cols-2"},{default:s(()=>[i("div",se,[t(e(f),null,{default:s(()=>[...o[3]||(o[3]=[n("Sale date",-1)])]),_:1}),t(e($),{modelValue:e(a).sale_date,"onUpdate:modelValue":o[0]||(o[0]=l=>e(a).sale_date=l),type:"date"},null,8,["modelValue"]),e(a).errors.sale_date?(m(),p("p",oe,r(e(a).errors.sale_date),1)):S("",!0)]),i("div",ae,[t(e(f),null,{default:s(()=>[...o[4]||(o[4]=[n("Deposit to",-1)])]),_:1}),t(e(F),{modelValue:e(a).deposit_account_id,"onUpdate:modelValue":o[1]||(o[1]=l=>e(a).deposit_account_id=l)},{default:s(()=>[t(e(L),null,{default:s(()=>[t(e(N),{placeholder:"Select account"})]),_:1}),t(e(T),null,{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(B),null,{default:s(()=>[...o[5]||(o[5]=[n("Bank / Cash",-1)])]),_:1}),(m(!0),p(y,null,V(v.depositAccounts,l=>(m(),w(e(h),{key:l.id,value:l.id},{default:s(()=>[n(r(l.code)+" — "+r(l.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(a).errors.deposit_account_id?(m(),p("p",le,r(e(a).errors.deposit_account_id),1)):S("",!0)])]),_:1})]),_:1}),t(e(C),null,{default:s(()=>[t(e(D),{class:"flex flex-row items-center justify-between"},{default:s(()=>[t(e(A),null,{default:s(()=>[...o[6]||(o[6]=[n("Items",-1)])]),_:1}),t(e(x),{type:"button",variant:"outline",size:"sm",onClick:q},{default:s(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),n(" "+r(e(d)("addLineItem")),1)]),_:1})]),_:1}),t(e(U),{class:"space-y-4"},{default:s(()=>[(m(!0),p(y,null,V(e(a).line_items,(l,b)=>(m(),p("div",{key:b,class:"space-y-3 rounded-md border p-4"},[i("div",ne,[i("div",re,"Line "+r(b+1),1),t(e(x),{type:"button",variant:"ghost",size:"sm",disabled:e(a).line_items.length<=1,onClick:u=>G(b)},{default:s(()=>[t(e(ee),{class:"h-4 w-4"})]),_:1},8,["disabled","onClick"])]),i("div",ie,[i("div",de,[t(e(f),null,{default:s(()=>[n(r(e(d)("description")),1)]),_:1}),t(e($),{modelValue:l.description,"onUpdate:modelValue":u=>l.description=u,placeholder:"e.g. Sale"},null,8,["modelValue","onUpdate:modelValue"])]),i("div",ue,[t(e(f),null,{default:s(()=>[n(r(e(d)("amount")),1)]),_:1}),t(e($),{modelValue:l.amount,"onUpdate:modelValue":u=>l.amount=u,type:"number",min:"0",step:"0.01"},null,8,["modelValue","onUpdate:modelValue"])])]),i("div",me,[t(e(f),null,{default:s(()=>[n(r(e(d)("incomeAccount")),1)]),_:1}),t(e(F),{modelValue:l.income_account_id,"onUpdate:modelValue":u=>l.income_account_id=u},{default:s(()=>[t(e(L),null,{default:s(()=>[t(e(N),{placeholder:e(d)("useCompanyDefault")},null,8,["placeholder"])]),_:1}),t(e(T),null,{default:s(()=>[t(e(j),null,{default:s(()=>[t(e(B),null,{default:s(()=>[...o[7]||(o[7]=[n("Revenue accounts",-1)])]),_:1}),t(e(h),{value:""},{default:s(()=>[n(r(e(d)("useCompanyDefault")),1)]),_:1}),(m(!0),p(y,null,V(v.revenueAccounts,u=>(m(),w(e(h),{key:u.id,value:u.id},{default:s(()=>[n(r(u.code)+" — "+r(u.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])])]))),128)),t(e(Y)),i("div",ce,[o[8]||(o[8]=i("div",{class:"text-sm text-muted-foreground"},"Total",-1)),i("div",_e,r(R(O.value)),1)]),i("div",pe,[t(e(x),{disabled:e(a).processing,onClick:H},{default:s(()=>[n(r(e(d)("save")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1})])]),_:1},8,["title","breadcrumbs"])],64))}});export{et as default};
